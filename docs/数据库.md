# 数据库(DcatAdmin的表除外)

本文档描述项目中自定义的数据库表结构（不包括DcatAdmin自带的表）。

## mirrors 表
存储镜像源信息

| 字段名 | 类型 | 注释 | 索引 |
|--------|------|------|------|
| id | bigint unsigned | 主键 | 主键 |
| name | string(100) | 镜像名称 | 索引 |
| type | string(50) | 镜像类型 | 联合索引(type,status) |
| url | string(500) | 镜像URL |  |
| status | tinyint | 状态:1启用,0禁用 | 联合索引(type,status) |
| config | json | 配置信息 |  |
| created_at | timestamp | 创建时间 |  |
| updated_at | timestamp | 更新时间 |  |

## sync_jobs 表
存储同步任务信息

| 字段名 | 类型 | 注释 | 索引 |
|--------|------|------|------|
| id | bigint unsigned | 主键 | 主键 |
| mirror_id | bigint unsigned | 镜像ID | 外键(关联mirrors.id), 联合索引(mirror_id,status) |
| status | string(20) | 状态 | 索引, 联合索引(mirror_id,status) |
| progress | int | 进度百分比 |  |
| log | text | 日志信息 |  |
| started_at | timestamp | 开始时间 |  |
| completed_at | timestamp | 完成时间 |  |
| created_at | timestamp | 创建时间 |  |
| updated_at | timestamp | 更新时间 |  |

## file_cache 表
文件缓存信息

| 字段名 | 类型 | 注释 | 索引 |
|--------|------|------|------|
| id | bigint unsigned | 主键 | 主键 |
| path | string(500) | 文件路径 | 唯一索引 |
| size | bigint | 文件大小 |  |
| hash | string(64) | 文件哈希 | 索引 |
| last_modified | timestamp | 最后修改时间 | 索引 |
| created_at | timestamp | 创建时间 |  |
| updated_at | timestamp | 更新时间 |  |

## system_configs 表
系统配置表

| 字段名 | 类型 | 注释 | 索引 |
|--------|------|------|------|
| id | bigint unsigned | 主键 | 主键 |
| key | string(100) | 配置键 | 唯一索引 |
| value | text | 配置值 |  |
| description | string(255) | 配置描述 |  |
| created_at | timestamp | 创建时间 |  |
| updated_at | timestamp | 更新时间 |  |

## access_logs 表
访问日志表

| 字段名 | 类型 | 注释 | 索引 |
|--------|------|------|------|
| id | bigint unsigned | 主键 | 主键 |
| ip | string(45) | 客户端IP | 联合索引(ip,created_at) |
| path | string(500) | 请求路径 | 索引 |
| method | string(10) | 请求方法 |  |
| status | int | 响应状态码 | 索引 |
| size | bigint | 响应大小 |  |
| user_agent | text | 用户代理 |  |
| created_at | timestamp | 创建时间 | 索引, 联合索引(ip,created_at) |
| updated_at | timestamp | 更新时间 |  |

## 外键关系
- `sync_jobs.mirror_id` 外键关联 `mirrors.id`
